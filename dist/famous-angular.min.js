/**
 * famous-angular - Allow famo.us components to work seamlessly with other components inside existing or future Angular apps
 * @version v0.0.0
 * @link https://github.com/FamousInternal/famous-angular
 * @license 
 */
"use strict";window.name="NG_DEFER_BOOTSTRAP!"+window.name;var requirements=["famous/core/Engine","famous/core/EventEmitter","famous/core/EventHandler","famous/core/Modifier","famous/core/RenderNode","famous/core/Surface","famous/core/Transform","famous/core/View","famous/core/ViewSequence","famous/events/EventArbiter","famous/events/EventFilter","famous/events/EventMapper","famous/inputs/FastClick","famous/inputs/GenericSync","famous/inputs/MouseSync","famous/inputs/PinchSync","famous/inputs/RotateSync","famous/inputs/TouchSync","famous/surfaces/ImageSurface","famous/surfaces/InputSurface","famous/transitions/Easing","famous/transitions/SpringTransition","famous/transitions/Transitionable","famous/transitions/TransitionableTransform","famous/utilities/KeyCodes","famous/utilities/Timer","famous/views/GridLayout","famous/views/RenderController","famous/views/Scroller","famous/views/Scrollview"],ngFameApp=angular.module("famous.angular",[]);require(requirements,function(){var required=arguments;ngFameApp.provider("$famous",function(){var _modules={};this.registerModule=function(key,module){_modules[key]=module},_modules.find=function(selector){var elems=angular.element(selector),scopes=_.map(elems,function(elem){return angular.element(elem).scope()}),isolates=_.map(scopes,function(scope){return scope.isolate[scope.$id]});return isolates},this.$get=function(){return _modules}}),ngFameApp.config(["$famousProvider",function($famousProvider){for(var i=0;i<requirements.length;i++)$famousProvider.registerModule(requirements[i],required[i])}]),angular.element(document).ready(function(){angular.resumeBootstrap()})}),angular.module("famous.angular").factory("$famousDecorator",function(){return{addRole:function(){},ensureIsolate:function(scope){scope.isolate=scope.isolate||{},scope.isolate[scope.$id]=scope.isolate[scope.$id]||{};var isolate=scope.isolate[scope.$id];isolate.id=scope.$id;var i=scope.$eval("$index");return i&&"$index"!==i&&!isolate.index&&(isolate.index=i),isolate}}}),angular.module("famous.angular").directive("faAnimation",["$famous","$famousDecorator",function($famous,famousDecorator){return{restrict:"EA",scope:!0,compile:function(){var Transform=$famous["famous/core/Transform"],Transitionable=$famous["famous/transitions/Transitionable"],Easing=$famous["famous/transitions/Easing"];return{pre:function(scope){famousDecorator.ensureIsolate(scope)},post:function(scope,element,attrs){var isolate=famousDecorator.ensureIsolate(scope);setTimeout(function(){isolate.timeline=scope.$eval(attrs.timeline),isolate._trans=new Transitionable(0),isolate.play=function(callback){var transition={duration:scope.$eval(attrs.duration),curve:scope.$eval(attrs.curve)||"linear"};isolate._trans.set(1,transition,function(){callback&&callback(),attrs.loop&&setTimeout(function(){isolate.replay(callback)},0)})},isolate.reset=function(){isolate._trans.set(0)},isolate.replay=function(callback){isolate.reset(),isolate.play(callback)};var _disengage=void 0;attrs.event&&(_disengage&&_disengage(),_disengage=scope.$on(attrs.event,function(evt,data){var callback=data&&data.callback?data.callback:void 0;isolate.replay(callback)}));attrs.id;if(void 0===isolate.timeline&&(isolate.timeline=isolate._trans.get.bind(isolate._trans),attrs.autoplay&&isolate.play()),!isolate.timeline instanceof Function)throw"timeline must be a reference to a function or duration must be provided";for(var animates=element.find("animate"),declarations={},i=0;i<animates.length;i++)!function(){var animate=animates[i];if(animate.attributes.targetmodselector){var modElements=element.parent().find(animate.attributes.targetmodselector.value);_.each(modElements,function(modElement){var modScope=angular.element(modElement).scope(),modifier=modScope.isolate[modScope.$id].modifier,getTransform=modScope.isolate[modScope.$id].getTransform,curve=animate.attributes.curve&&"linear"!==animate.attributes.curve.value?Easing[animate.attributes.curve.value]:function(j){return j};if(animate.attributes.field){var field=animate.attributes.field.value,lowerBound=animate.attributes.timelinelowerbound?parseFloat(animate.attributes.timelinelowerbound.value):0,upperBound=animate.attributes.timelineupperbound?parseFloat(animate.attributes.timelineupperbound.value):1;if(!animate.attributes.startvalue)throw"you must provide a start value for the animation";var startValue=scope.$eval(animate.attributes.startvalue.value);if(!animate.attributes.endvalue)throw"you must provide an end value for the animation";var endValue=scope.$eval(animate.attributes.endValue.value),modDecs=declarations[modScope.$id]=declarations[modScope.$id]||{},segments=modDecs[field]=modDecs[field]||[];segments.push({field:field,lowerBound:lowerBound,upperBound:upperBound,startValue:startValue,endValue:endValue,curve:curve}),segments.sort(function(a,b){return a.lowerBound-b.lowerBound});for(var j=1;j<segments.length;j++)for(var lower=segments[j].lowerBound,k=0;j>k;k++)if(lower<segments[k].upperBound)throw"Animate segments have overlapping                                 domains for the same field ("+field+").                                 At any point in the timeline, only one <animate>                                 can affect a given field on the same modifier.";var transformFunction=function(){for(var x=isolate.timeline()||0,relevantIndex=0,relevantSegment=segments[relevantIndex],j=0;j<segments.length;j++){if(x>=segments[j].lowerBound&&x<=segments[j].upperBound){relevantSegment=segments[j];break}if(j===segments.length-1){relevantSegment=segments[j];break}if(x>=segments[j].upperBound&&x<segments[j+1].lowerBound){relevantSegment=segments[j];break}}if(x<=relevantSegment.lowerBound)return relevantSegment.startValue;if(x>=relevantSegment.upperBound)return relevantSegment.endValue;var subDomain=relevantSegment.upperBound-relevantSegment.lowerBound,normalizedX=(x-relevantSegment.lowerBound)/subDomain;if(Array.isArray(relevantSegment.startValue)){for(var ret=[],j=0;j<relevantSegment.startValue.length;j++)ret.push(relevantSegment.startValue[j]+relevantSegment.curve(normalizedX)*(relevantSegment.endValue[j]-relevantSegment.startValue[j]));return ret}return relevantSegment.startValue+relevantSegment.curve(normalizedX)*(relevantSegment.endValue-relevantSegment.startValue)},transformComponents=modDecs.transformComponents=modDecs.transformComponents||[];"opacity"===field?modifier.opacityFrom(function(){return transformFunction()}):"origin"===field?modifier.originFrom(function(){return transformFunction()}):"size"===field?modifier.sizeFrom(function(){return transformFunction()}):(transformComponents.push({field:field,fn:transformFunction}),modifier.transformFrom(function(){for(var mult=getTransform&&getTransform()?[getTransform()]:[],j=0;j<transformComponents.length;j++)!function(){var transVal=transformComponents[j].fn(),f=transformComponents[j].field;mult.push(Array.isArray(transVal)?Transform[f].apply(this,transVal):Transform[f](transVal))}();return 1===mult.length?mult[0]:Transform.multiply.apply(this,mult)}))}})}}()},1)}}}}}]),angular.module("famous.angular").directive("faApp",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:'<div style="display: none;"><div></div></div>',transclude:!0,scope:{},restrict:"EA",compile:function(tElement,tAttrs,transclude){return{pre:function(scope,element){function AppView(){View.apply(this,arguments)}{var View=($famousDecorator.ensureIsolate(scope),$famous["famous/core/View"]),Engine=$famous["famous/core/Engine"];$famous["famous/core/Transform"]}element.append('<div class="famous-angular-container"></div>');var famousContainer=$(element.find(".famous-angular-container"))[0];scope.context=Engine.createContext(famousContainer),AppView.prototype=Object.create(View.prototype),AppView.prototype.constructor=AppView;scope.view=new AppView,scope.context.add(scope.view),scope.$on("registerChild",function(evt,data){scope.view.add(data.renderNode),evt.stopPropagation()})},post:function(scope,element){transclude(scope,function(clone){element.find("div div").append(clone)}),scope.readyToRender=!0}}}}}]),angular.module("famous.angular").directive("faClick",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faClick){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("click",function(data){var fn=$parse(attrs.faClick);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faGridLayout",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),GridLayout=$famous["famous/views/GridLayout"],_children=($famous["famous/core/ViewSequence"],[]),options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new GridLayout(options);var updateGridLayout=function(){_children.sort(function(a,b){return a.index-b.index}),isolate.renderNode.sequenceFrom(_.map(_children,function(c){return c.renderNode}))};scope.$on("registerChild",function(evt,data){evt.targetScope.$id!=scope.$id&&(_children.push(data),updateGridLayout(),evt.stopPropagation())}),scope.$on("unregisterChild",function(evt,data){evt.targetScope.$id!=scope.$id&&(_children=_.reject(_children,function(c){return c.id===data.id}),updateGridLayout(),evt.stopPropagation())})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faImageSurface",["$famous","$famousDecorator",function($famous,$famousDecorator){return{scope:!0,template:'<div class="fa-image-surface"></div>',restrict:"EA",compile:function(){return{pre:function(scope,element,attrs){{var isolate=$famousDecorator.ensureIsolate(scope),ImageSurface=$famous["famous/surfaces/ImageSurface"];$famous["famous/core/Transform"],$famous["famous/core/EventHandler"]}scope.$watch(function(){return isolate.getProperties()},function(){isolate.renderNode&&isolate.renderNode.setProperties(isolate.getProperties())},!0),isolate.getProperties=function(){return{backgroundColor:scope.$eval(attrs.faBackgroundColor),color:scope.$eval(attrs.faColor)}};isolate.renderNode=new ImageSurface({size:scope.$eval(attrs.faSize),"class":scope.$eval(attrs.class),properties:isolate.getProperties()}),attrs.class&&isolate.renderNode.setClasses(attrs["class"].split(" "))},post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),updateContent=function(){isolate.renderNode.setContent(attrs.faImageUrl)};updateContent(),attrs.$observe("faImageUrl",updateContent),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faIndex",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.index=scope.$eval(attrs.faIndex),scope.$watch(function(){return scope.$eval(attrs.faIndex)},function(){isolate.index=scope.$eval(attrs.faIndex)})}}}}}]),angular.module("famous.angular").directive("faModifier",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",transclude:!0,restrict:"EA",priority:2,scope:!0,compile:function(tElement,tAttrs,transclude){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),RenderNode=$famous["famous/core/RenderNode"],Modifier=$famous["famous/core/Modifier"],Transform=$famous["famous/core/Transform"],get=function(x){return x instanceof Function?x():x.get?x.get():x};isolate.getTransform=function(){var transforms=[];if(attrs.faTranslate){var values=scope.$eval(attrs.faTranslate).map(get);transforms.push(Transform.translate.apply(this,values))}if(attrs.faRotate){var values=scope.$eval(attrs.faRotate).map(get);transforms.push(Transform.rotate.apply(this,values))}if(attrs.faRotateX&&transforms.push(Transform.rotateX(get(scope.$eval(attrs.faRotateX)))),attrs.faRotateY&&transforms.push(Transform.rotateY(get(scope.$eval(attrs.faRotateY)))),attrs.faRotateZ&&transforms.push(Transform.rotateZ(get(scope.$eval(attrs.faRotateZ)))),attrs.faScale){var values=scope.$eval(attrs.faScale).map(get);transforms.push(Transform.scale.apply(this,values))}if(attrs.faSkew){var values=scope.$eval(attrs.faSkew).map(get);transforms.push(Transform.skew.apply(this,values))}return transforms.length?1===transforms.length?transforms[0]:Transform.multiply.apply(this,transforms):void 0},isolate.getOpacity=function(){return attrs.faOpacity?get(scope.$eval(attrs.faOpacity)):1},isolate.modifier=new Modifier({transform:isolate.getTransform,size:scope.$eval(attrs.faSize),opacity:isolate.getOpacity,origin:scope.$eval(attrs.faOrigin)}),isolate.renderNode=(new RenderNode).add(isolate.modifier),scope.$on("$destroy",function(){isolate.modifier.setOpacity(0),scope.$emit("unregisterChild",{id:scope.$id})}),scope.$on("registerChild",function(evt,data){evt.targetScope.$id!==evt.currentScope.$id&&(isolate.renderNode.add(data.renderNode),evt.stopPropagation())}),transclude(scope,function(clone){element.find("div").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faPipeFrom",["$famous","$famousDecorator",function($famous,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){var Engine=$famous["famous/core/Engine"];return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);scope.$watch(function(){return scope.$eval(attrs.faPipeFrom)},function(newTarget,oldTarget){var source=isolate.renderNode||Engine;if(oldTarget instanceof Array)for(var i=0;i<oldTarget.length;i++)oldTarget[i].unpipe(source);else void 0!==oldTarget&&oldTarget.unpipe(source);if(newTarget instanceof Array)for(var i=0;i<newTarget.length;i++)newTarget[i].pipe(source);else void 0!==newTarget&&newTarget.pipe(source)})}}}}}]),angular.module("famous.angular").directive("faPipeTo",["$famous","$famousDecorator",function($famous,$famousDecorator){return{restrict:"A",scope:!1,priority:16,compile:function(){var Engine=$famous["famous/core/Engine"];return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);scope.$watch(function(){return scope.$eval(attrs.faPipeTo)},function(newPipe,oldPipe){var target=isolate.renderNode||Engine;if(oldPipe instanceof Array)for(var i=0;i<oldPipe.length;i++)target.unpipe(oldPipe[i]);else void 0!==oldPipe&&target.unpipe(oldPipe);if(newPipe instanceof Array)for(var i=0;i<newPipe.length;i++)target.pipe(newPipe[i]);else void 0!==newPipe&&target.pipe(newPipe)})}}}}}]),angular.module("famous.angular").directive("faRenderNode",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",transclude:!0,scope:!0,restrict:"EA",compile:function(tElement,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),Engine=$famous["famous/core/Engine"];isolate.children=[],attrs.$observe("faPipeTo",function(val){var pipeTo=scope.$eval(val);pipeTo&&Engine.pipe(pipeTo)}),isolate.renderNode=scope.$eval(attrs.faNode),scope.$on("$destroy",function(){scope.$emit("unregisterChild",{id:scope.$id})}),scope.$on("registerChild",function(evt,data){evt.targetScope.$id!=scope.$id&&(isolate.renderNode.add(data.renderNode),isolate.children.push(data),evt.stopPropagation())})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faScrollView",["$famous","$famousDecorator","$timeout",function($famous,$famousDecorator,$timeout){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope),ScrollView=$famous["famous/views/Scrollview"],ViewSequence=$famous["famous/core/ViewSequence"],_children=($famous["famous/core/Surface"],[]),options=scope.$eval(attrs.faOptions)||{};isolate.renderNode=new ScrollView(options);var updateScrollview=function(init){$timeout(function(){_children.sort(function(a,b){return a.index-b.index});var options={array:_.map(_children,function(c){return c.renderNode})};init&&(options.index=scope.$eval(attrs.faStartIndex));var viewSeq=new ViewSequence(options);isolate.renderNode.sequenceFrom(viewSeq)})};scope.$on("registerChild",function(evt,data){evt.targetScope.$id!=scope.$id&&(_children.push(data),updateScrollview(!0),evt.stopPropagation())}),scope.$on("unregisterChild",function(evt,data){evt.targetScope.$id!=scope.$id&&(_children=_.reject(_children,function(c){return c.id===data.id}),updateScrollview(),evt.stopPropagation())})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faSurface",["$famous","$famousDecorator","$interpolate","$controller","$compile",function($famous,$famousDecorator,$interpolate,$controller,$compile){return{scope:!0,transclude:!0,template:'<div class="fa-surface"></div>',restrict:"EA",compile:function(tElem,tAttrs,transclude){return{pre:function(scope,element,attrs){{var isolate=$famousDecorator.ensureIsolate(scope),Surface=$famous["famous/core/Surface"];$famous["famous/core/Transform"],$famous["famous/core/EventHandler"]}scope.$watch(function(){return isolate.getProperties()},function(){isolate.renderNode&&isolate.renderNode.setProperties(isolate.getProperties())},!0),isolate.getProperties=function(){return{backgroundColor:scope.$eval(attrs.faBackgroundColor),color:scope.$eval(attrs.faColor)}};var modifiers={origin:scope.$eval(attrs.faOrigin),translate:scope.$eval(attrs.faTranslate),rotateZ:scope.$eval(attrs.faRotateZ),skew:scope.$eval(attrs.faSkew)};isolate.renderNode=new Surface({size:scope.$eval(attrs.faSize),"class":scope.$eval(attrs.class),properties:isolate.getProperties()}),attrs.class&&isolate.renderNode.setClasses(attrs["class"].split(" ")),isolate.modifier=function(){return modifiers}},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope),updateContent=function(){isolate.compiledEl=isolate.compiledEl||$compile(element.find("div.fa-surface").contents())(scope);isolate.renderNode.setContent(isolate.compiledEl.context)};updateContent(),transclude(scope,function(clone){element.find("div.fa-surface").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]),angular.module("famous.angular").directive("faTap",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTap){var renderNode=isolate.renderNode._eventInput||isolate.renderNode,_dragging=!1;renderNode.on("touchmove",function(data){return _dragging=!0,data}),renderNode.on("touchend",function(data){if(!_dragging){var fn=$parse(attrs.faTap);fn(scope,{$event:data}),scope.$$phase||scope.$apply()}_dragging=!1})}}}}}}]),angular.module("famous.angular").directive("faTouchend",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTouchEnd){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("touchend",function(data){var fn=$parse(attrs.faTouchMove);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faTouchmove",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTouchMove){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("touchmove",function(data){var fn=$parse(attrs.faTouchMove);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faTouchstart",["$parse","$famousDecorator",function($parse,$famousDecorator){return{restrict:"A",scope:!1,compile:function(){return{post:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);if(attrs.faTouchStart){var renderNode=isolate.renderNode._eventInput||isolate.renderNode;renderNode.on("touchstart",function(data){var fn=$parse(attrs.faTouchStart);fn(scope,{$event:data}),scope.$$phase||scope.$apply()})}}}}}}]),angular.module("famous.angular").directive("faView",["$famous","$famousDecorator",function($famous,$famousDecorator){return{template:"<div></div>",transclude:!0,scope:!0,restrict:"EA",compile:function(tElement,tAttrs,transclude){var View=$famous["famous/core/View"];return{pre:function(scope,element,attrs){var isolate=$famousDecorator.ensureIsolate(scope);isolate.children=[];isolate.renderNode=new View({size:scope.$eval(attrs.faSize)||[void 0,void 0]}),scope.$on("$destroy",function(){scope.$emit("unregisterChild",{id:scope.$id})}),scope.$on("registerChild",function(evt,data){evt.targetScope.$id!=scope.$id&&(isolate.renderNode.add(data.renderNode),isolate.children.push(data),evt.stopPropagation())})},post:function(scope,element){var isolate=$famousDecorator.ensureIsolate(scope);transclude(scope,function(clone){element.find("div").append(clone)}),scope.$emit("registerChild",isolate)}}}}}]);